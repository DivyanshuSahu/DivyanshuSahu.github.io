<!DOCTYPE html>
<html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width" , initial-scale=1, viewport-fit="cover">
    <title>Natas</title>
    <meta name="description" content="Hints for the BACKDOOR CTF challenge">
    <link rel="icon" type="image" href="../../favicon.ico">
    <link rel="stylesheet" type="text/css" href="../../assets/bootstrap/css/bootstrap.min.css">
    <link href='https://fonts.googleapis.com/css?family=ABeeZee' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Belgrano' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet'>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
    <div class="top-bar">
        <ul>
            <li><a href="https://github.com/DivyanshuSahu?tab=repositories">Projects</a></li>
            <li><a href="#">Blogs</a></li>
            <li><a href="../index.html">Write-Ups</a></li>
            <li><a href="../../index.html">Home</a></li>
        </ul>
    </div>
    <div class="container">
        <div class="title">
            <h1>Natas - OverTheWire</h1>
        </div>
        <div class="date">
            <p>11 December 2017</p>
        </div>
        <div class="challenge">
        	<div id="natas0" class="natas">
                <h2>Natas 0</h2>
                <p>Read the source code of the web page to get the password of the next level.</p>
                <p><b>natas1:gtVrDuiDfck831PqWsLEZy5gyDz1clto</b></p>
            </div>
            <div id="natas1" class="natas">
                <h2>Natas 1</h2>
                <p>Again the password for the next level is hidden inside the source code but this time rightclicking has been blocked. There are many ways to bypass this like curl, python etc. but simplest is Ctrl+u in the browser.</p>
                <p><b>natas2:ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi</b></p>
            </div>
            <div id="natas2" class="natas">
                <h2>Natas 2</h2>
                <p>Again with the help of the source code, we found that there is an image file included in the web page. The location of the image file is /files/pixel.png/. Moving one directory back ie at /files/ we are able to see the directory listing which contains another file users.txt. This file contains the password for the next level.</p>
                <p><b>natas3:sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14</b></p>
            </div>
            <div id="natas3" class="natas">
                <h2>Natas 3</h2>
                <p>After looking at the source code. <i>Not even Google will find it this time...</i> This line gives the hint of robots.txt.</p>
                <div class="description">
                    <p>User-agent: *</p>
                    <p>Disallow: /s3cr3t/</p>
                </div>
                <p>Navigating on /s3cr3t/ we found that the directory contains users.txt  which contains password of the next level.</p>
                <p><b>natas4:Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ</b></p>
            </div>
            <div id="natas4" class="natas">
                <h2>Natas 4</h2>
                <p>The challenge description says, <i>Access disallowed, authorized users should come only from "http://natas5.natas.labs.overthewire.org/"</i>. Now this time Referer headers comes into play. While making requests Referer header tells the server from where the request is originated. We need to send the custom Referer header to bypass this level. I use <a href="files/natas4.py">python</a> for this purpose.</p>
                <div class="description">
                    import requests
                    <br>target = 'http://natas4.natas.labs.overthewire.org/'
                    <br>header = {'Referer':'http://natas5.natas.labs.overthewire.org/'}
                    <br>r = requests.get(target, headers=header, auth=('natas4','Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ'))
                    <br>print r.text
                </div>
                <p><b>natas5:iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq</b></p>
            </div>
            <div id="natas5" class="natas">
                <h2>Natas 5</h2>
                <p><i>Access disallowed. You are not logged in</i>.</p>
                <p> Seems interesting. Lets look at the cookies.</p>
                <div class="description">
                    import requests
                    <br>target = "http://natas5.natas.labs.overthewire.org"
                    <br>r = requests.get(target, auth=('natas5','iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq'))
                    <br>print r.cookies
                </div>
                <p>We see a cookie named loggedin and its value is set to 0. <a href="files/natas5.py">Changing</a> it to 1 or any other non-zero value, we get the password for the next level.</p>
                <div class="description">
                    import requests
                    <br>target = "http://natas5.natas.labs.overthewire.org"
                    <br>cookie = {"loggedin":"1"}
                    <br>r = requests.get(target, auth=('natas5','iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq'))
                    <br>print r.text
                </div>
                <p><b>natas6:aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1</b></p>
            </div>
        </div>
    </div>
</body>

</html>